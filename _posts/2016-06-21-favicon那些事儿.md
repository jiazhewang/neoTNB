---
layout: post
title: favicon那些事儿
tag: 技术 设计
---

> 这篇文章介绍了 UI 设计师和 web 工程师们都应该了解的 favicon。
> 顺便解释了一下一些更深入的文件格式知识。
> 以及 favicon 的制作和在网页代码中的使用方法。

## 啥是favicon呀?

favicon， 也就是 favorite icon（收藏图标）的简称。当我们在浏览器上访问网站的时候，每个网站的 favicon 会出现在浏览器标签栏对应网站的标签上，网站标题的左边。当你收藏一个网站的时候，可以在收藏夹里看到这个图标，以此来表示对应网站。通常，网站会直接使用自己或者公司的 logo 来做 favicon。

![favicon就是它]({{ site.url }}/assets/img/itisfavicon.png)

favicon 是网站设计和开发中最基础的环节之一，是所有 UI 设计师和 web 工程师都应该了解的内容。

<!-- more -->

## 格式：`.ico` vs `.png`

通常，favicon 会使用`.ico`后缀格式，`.ico`文件是可以存储单个图案、多尺寸、多色板的图标文件。一个图标实际上是多张不同格式的图片的集合体，并且还包含了一定的透明区域。

但是，随着新协议的允许，现在的标准越来越流行使用`.png`格式的 favicon 了。那么`.png`到底好在哪里呢？

### 更易制作的`.png`

作为大家熟悉的图片格式，`.png`可以通过诸多软件制作，Photoshop、AI、sketch 等主流设计类软件都支持`.png`文件的编辑和导出。

相比之下，`.ico`文件不太被熟知，更多被应用在微软的 Windows 系统中。许多设计类工具，包括最主流的 Photoshop 等都不支持`.ico`文件的编辑和导出。不太熟练的设计师和开发者可能需要搜索许多方法来制作`.ico`文件。比如说类似[convertico.com](http://convertico.com/)的一些在线的格式转换网站，或者是一些 app 工具，就像 Mac 上的 [Icon Slate](https://itunes.apple.com/cn/app/icon-slate/id439697913?mt=12)。

虽然做多了以后都不会很复杂，但是`.png`还是更接地气一些。

### 显示效果更好的`.png`

有一种说法是，除了是更加通用的图片格式以外，`.png`的显示效果更好。理由是，`.png`格式允许使用**8位 alpha 通道的透明度（ 8-bit alpha-channel transparency）**，这可以使得你的 favicon 在一些特殊背景色下有更好的展示效果。有些浏览器的标签栏是白色的，有些是灰色的，有些还可以套用不同的浏览器主题，变成彩色的。在各种背景色下，`.png`格式的 favicon 因为更高级的透明度机制，都可以有较好的显示效果。

但是也有说法是，`.ico`也支持32位色的图片，也就是也支持8位的透明度。说道这个问题，不免就要提一提这些都是什么意思了。

#### 位&图

当我们用数字来存储一张图片，可以想象无非就是裁好一张画布有多大，把画布分割成数以万计的小方格（像素点），每种方格上用记号表示一种颜色（比如用5201314表示屎色），大概就是这样子。但是颜色有那么多种，我们人眼的感光细胞分为视杆细胞和视锥细胞，其中视锥细胞用来感受颜色，我们人类有三种，所以就有三原色，而皮皮虾有16种，所以......额，不谈了吧，扯远了。想听冷知识的朋友可以[戳这里看小黄图]({{ site.url }}/assets/img/pipixia.jpg)。

我们重新说啊，啥是 favicon 呀？......大概就是这样子。但是颜色有那么多种，我们如何来用数字记录下来呢？我们知道计算机里都是用0和1来搞事情的。100111010110101010101111100101010100001...这样子。那么当然是0或1的数字位数越多，能记录的信息量越大啦。这就扯到了**位（bit）**的概念。32位色，就是说拿32个数字位来表示一个颜色。蹊跷的是，颜色这个东西吧，它还有个透明度呢。透明度不同，颜色那是大大滴不同啊。

记录一张图片，怎么记录是由系统和格式规定的。对于*小于32位色*的格式，统一用一种方式：用一个**颜色层（color mask）**和一个**不透明度层（opacity mask）**叠加的方式来表示。通常不透明度层用1位表示每个像素到底是透明还是不透明。

> 科普一下，**opacity = 不透明度**，**transparency = 透明度**，有些朋友经常搞反哇。

> 颜色层又叫 XOR mask （异或层），不透明度层又叫 AND mask（与层），学计算机的朋友可以根据真值表来感性理解一下。

而对于32位色图，其实是一个24位的图加上一个8位的通道专门记录**alpha 混合（alpha compositing）**。至于这又是什么，我们就不再多说了，反正就是可以表现华丽丽的透明感。

所以我们回过头来看，到底`.ico`的透明度表现比`.png`差吗？绕了一圈我们还是要回归`.ico`的定义，其实它就是把很多小图片打包了嘛。为什么它多用在 Windows 上？还记得用 Windows 的时候，是可以设置桌面图标大小的吗？根据你设置的不同，【我的电脑】会显示16×16（小图标）、32×32、48×48、24×24、64×64、128×128的尺寸。Windows vista 以后，256×256也可以显示了。所以，一个`.ico`文件里，其实就包含了这么多不同尺寸的图片。那么`.ico`文件是不是32位图呢？那就看它里面的图片文件一开始是不是32位图嘛！

**综上**，我觉得所谓`.png`显示效果就比`.ico`牛是武断的说法。但可以认同的是`.ico`更杂水更深，你不确定它的透明度效果就是好的，除非是你用正确的方式制作出来的。而谈到为什么许多人现在喜欢用`.png`，更主要的原因，我认为还是`.png`更易制作、编辑、和导出。

> 更多的 favicon 设计知识参见[这里](https://realfavicongenerator.net/faq#.V2ky8ZN97OQ)。

## 怎么把`.ico`文件放到网页上呢？

其实很简单，其实很自然...在 HTML 代码的`<head>`里加一行代码，引用你的`favicon.ico`文件就可以了。

{% highlight html %}
<link href="/host/favicon.ico" rel="shortcut icon">
{% endhighlight %}

一般我们会直接把这个文件就命名为`favicon.ico`。然后放在网站的根目录下，不会和其他图片文件放在一起。这样做是因为有一些浏览器（比如360安全浏览器，呵呵）会忽略你的端口啊路径啊什么的，直接优先访问根目录下的`favicon.ico`文件。所以，为了确保你的 favicon 起作用，或者说让兼容性更好，我们要把它放在根目录下，也就是`http://host/favicon.ico`，而不是`http://host/somepath/favicon.ico`。比如我的网站，就是放在`http://uncleneo.com/favicon.ico`。

## 怎么把`.png`文件放到网页上呢？

让我们先来看一下老派的做法，也就是`.ico`文件的设置。

一般来说，我们要先制作好一个至少包含了32x32尺寸的32位图的`.ico`文件。最好包含的尺寸多一些，我们要考虑到其跨浏览器的特性需要。

比如说，我们先来看 IE 这个愚蠢的浏览器。在 IE11 版本之前，它都是不支持用`.png`来做 favicon 的。所以为了它之前的版本，我们要在代码开头为 IE9 它老人家以及比它更老的人家加上一行：

{% highlight html %}
<!--[if IE]><link rel="shortcut icon" href="path/to/favicon.ico"><![endif]-->
{% endhighlight %}

> 这里插播一个笑话：由于 IE10 既不支持`.png`又不支持条件注释，所以它在这种情况下...没法显示 favicon！好在 IE10 也没什么人用，这里我们选择忽略它！谁是 IE10？ 我不认识。另外，鼓励所有程序员和设计师使用`Google Chrome`浏览器。不用挑了，就是它！

另外，值得一提的是，Chrome 和 Safari 这样的浏览器会自动使用`.ico`文件，只要它们发现代码里有。所以我们要写在`if`条件里。

对于`.png`，标准的做法是，加入这样一行：

{% highlight html %}
<link rel="icon" href="path/to/favicon.png">
{% endhighlight %}

这个`favicon.png`应该是`196x196 px`的尺寸，这样可以兼容几乎所有设备。

要想让它也适用于移动设备上的touch icon，我们可以用苹果的私有属性：

{% highlight html %}
<link rel="apple-touch-icon-precomposed" href="apple-touch-icon-precomposed.png">
{% endhighlight %}

> 设置`apple-touch-icon-precomposed`属性（预处理）不会让你的图标在 iOS 上加上苹果默认的那种图标反光，如果要加上那种效果，可以改用`apple-touch-icon`属性。其他一些厂商（如黑莓）也会沿用`apple-touch-icon-precomposed`属性，他们并没有那种反光效果。

这个`apple-touch-icon-precomposed.png`图片应该是`180x180 px`的尺寸。这是苹果官方的建议。

> 提醒一点：这个属性动不动就可能被停用，特别是安卓和谷歌系的其他产品。

提了苹果，顺带也提一下微软。微软 IE11 以上的磁贴设计，对 icon 的建议是涵盖一系列尺寸的透明图片。有了这些图片以后还需要建立一个`xml`文件叫做`browserconfig.xml`放到你站点的根目录下，然后 link 到页面中去。由于本人不太偏爱微软的东西，这里不细说了，对不起！各位可以去看[微软的官方介绍](http://msdn.microsoft.com/en-us/library/ie/dn455106%28v=vs.85%29.aspx)。如果你竟然还想兼容 Windows Phone，那么也请去看[微软相关的介绍](http://blogs.windows.com/windows_phone/b/wpdev/archive/2012/10/19/creating-a-custom-tile-to-link-to-your-website.aspx)吧。


## 总结

**综上**，你为了 favicon 所做的代码应该是这个样子：

{% highlight html %}
<!-- For IE 9 and below. ICO should be 32x32 pixels in size -->
<!--[if IE]><link rel="shortcut icon" href="path/to/favicon.ico"><![endif]-->

<!-- Touch Icons - iOS and Android 2.1+ 180x180 pixels in size. --> 
<link rel="apple-touch-icon-precomposed" href="apple-touch-icon-precomposed.png">

<!-- Firefox, Chrome, Safari, IE 11+ and Opera. 196x196 pixels in size. -->
<link rel="icon" href="path/to/favicon.png">
{% endhighlight %}

最后，关于 favicon 的更多设计信息，可以参考以下几个网站：

- [real favicon generator](https://realfavicongenerator.net/)
- [wikipedia/favicon](https://en.wikipedia.org/wiki/Favicon)
